!function($,window,document,undefined){var selector,opt,_init,_trigger,_clicked,_target,_to,_axis,_offset,_dataOffset,_liveTimer,pluginNS="mPageScroll2id",pluginPfx="mPS2id",defaultSelector=".m_PageScroll2id,a[rel~='m_PageScroll2id'],.page-scroll-to-id,a[rel~='page-scroll-to-id'],._ps2id",defaults={scrollSpeed:1300,autoScrollSpeed:!0,scrollEasing:"easeInOutExpo",scrollingEasing:"easeInOutCirc",pageEndSmoothScroll:!0,layout:"vertical",offset:0,highlightSelector:!1,clickedClass:pluginPfx+"-clicked",targetClass:pluginPfx+"-target",highlightClass:pluginPfx+"-highlight",forceSingleHighlight:!1,keepHighlightUntilNext:!1,highlightByNextTarget:!1,disablePluginBelow:!1,clickEvents:!0,onStart:function(){},onComplete:function(){},defaultSelector:!1,live:!0},_totalInstances=0,methods={init:function(options){var options=$.extend(!0,{},defaults,options);if($(document).data(pluginPfx,options),opt=$(document).data(pluginPfx),!this.selector){var selectorClass="__"+pluginPfx;this.each(function(){var el=$(this);el.hasClass(selectorClass)||el.addClass(selectorClass)}),this.selector="."+selectorClass}selector=selector?selector+","+this.selector:this.selector,opt.defaultSelector&&("object"!=typeof $(selector)||0===$(selector).length)&&(selector=defaultSelector),opt.clickEvents&&$(document).undelegate("."+pluginPfx).delegate(selector,"click."+pluginPfx,function(e){if(functions._isDisabled.call(null))return void functions._removeClasses.call(null);var $this=$(this),href=$this.attr("href"),hrefProp=$this.prop("href");href&&-1!==href.indexOf("#/")||(functions._reset.call(null),_dataOffset=$this.data("ps2id-offset")||0,functions._isValid.call(null,href,hrefProp)&&functions._findTarget.call(null,href)&&(e.preventDefault(),_trigger="selector",_clicked=$this,functions._setClasses.call(null,!0),functions._scrollTo.call(null)))}),$(window).unbind("."+pluginPfx).bind("scroll."+pluginPfx+" resize."+pluginPfx,function(){if(functions._isDisabled.call(null))return void functions._removeClasses.call(null);var targets=$("._"+pluginPfx+"-t");targets.each(function(i){var t=$(this),id=t.attr("id"),h=functions._findHighlight.call(null,id);functions._setClasses.call(null,!1,t,h),i==targets.length-1&&functions._extendClasses.call(null)})}),_init=!0,functions._setup.call(null),functions._live.call(null)},scrollTo:function(id,options){if(functions._isDisabled.call(null))return void functions._removeClasses.call(null);if(id&&"undefined"!=typeof id){functions._isInit.call(null);var defaults={layout:opt.layout,offset:opt.offset,clicked:!1},options=$.extend(!0,{},defaults,options);functions._reset.call(null),_axis=options.layout,_offset=options.offset,id=-1!==id.indexOf("#")?id:"#"+id,functions._isValid.call(null,id)&&functions._findTarget.call(null,id)&&(_trigger="scrollTo",_clicked=options.clicked,_clicked&&functions._setClasses.call(null,!0),functions._scrollTo.call(null))}},destroy:function(){$(window).unbind("."+pluginPfx),$(document).undelegate("."+pluginPfx).removeData(pluginPfx),$("._"+pluginPfx+"-t").removeData(pluginPfx),functions._removeClasses.call(null,!0)}},functions={_isDisabled:function(){var e=window,a="inner",val=opt.disablePluginBelow instanceof Array?[opt.disablePluginBelow[0]||0,opt.disablePluginBelow[1]||0]:[opt.disablePluginBelow||0,0];return"innerWidth"in window||(a="client",e=document.documentElement||document.body),e[a+"Width"]<=val[0]||e[a+"Height"]<=val[1]},_isValid:function(href,hrefProp){if(href){hrefProp=hrefProp?hrefProp:href;var str=-1!==hrefProp.indexOf("#/")?hrefProp.split("#/")[0]:hrefProp.split("#")[0],loc=window.location.toString().split("#")[0];return"#"!==href&&-1!==href.indexOf("#")&&(""===str||str===loc)}},_setup:function(){var el=functions._highlightSelector(),i=1,tp=0;return $(el).each(function(){var $this=$(this),href=$this.attr("href"),hrefProp=$this.prop("href");if(functions._isValid.call(null,href,hrefProp)){var id=-1!==href.indexOf("#/")?href.split("#/")[1]:href.split("#")[1],t=$("#"+id);if(t.length>0){opt.highlightByNextTarget&&t!==tp&&(tp?tp.data(pluginPfx,{tn:t}):t.data(pluginPfx,{tn:"0"}),tp=t),t.hasClass("_"+pluginPfx+"-t")||t.addClass("_"+pluginPfx+"-t"),t.data(pluginPfx,{i:i}),$this.hasClass("_"+pluginPfx+"-h")||$this.addClass("_"+pluginPfx+"-h");var h=functions._findHighlight.call(null,id);functions._setClasses.call(null,!1,t,h),_totalInstances=i,i++,i==$(el).length&&functions._extendClasses.call(null)}}})},_highlightSelector:function(){return opt.highlightSelector&&""!==opt.highlightSelector?opt.highlightSelector:selector},_findTarget:function(str){var val=-1!==str.indexOf("#/")?str.split("#/")[1]:str.split("#")[1],el=$("#"+val);if(el.length<1||"fixed"===el.css("position")){if("top"!==val)return;el=$("body")}return _target=el,_axis||(_axis=opt.layout),_offset=functions._setOffset.call(null),_to=[(el.offset().top-_offset[0]).toString(),(el.offset().left-_offset[1]).toString()],_to[0]=_to[0]<0?0:_to[0],_to[1]=_to[1]<0?0:_to[1],_to},_setOffset:function(){_offset||(_offset=opt.offset?opt.offset:0),_dataOffset&&(_offset=_dataOffset);var val,obj,y,x;switch(typeof _offset){case"object":case"string":val=[_offset.y?_offset.y:_offset,_offset.x?_offset.x:_offset],obj=[val[0]instanceof jQuery?val[0]:$(val[0]),val[1]instanceof jQuery?val[1]:$(val[1])],obj[0].length>0?(y=obj[0].height(),"fixed"===obj[0].css("position")&&(y+=obj[0][0].offsetTop)):y=!isNaN(parseFloat(val[0]))&&isFinite(val[0])?parseInt(val[0]):0,obj[1].length>0?(x=obj[1].width(),"fixed"===obj[1].css("position")&&(x+=obj[1][0].offsetLeft)):x=!isNaN(parseFloat(val[1]))&&isFinite(val[1])?parseInt(val[1]):0;break;case"function":val=_offset.call(null),val instanceof Array?(y=val[0],x=val[1]):y=x=val;break;default:y=x=parseInt(_offset)}return[y,x]},_findHighlight:function(id){var loc=window.location.toString().split("#")[0],hHash=$("._"+pluginPfx+"-h[href='#"+id+"']"),lhHash=$("._"+pluginPfx+"-h[href='"+loc+"#"+id+"']"),hHashSlash=$("._"+pluginPfx+"-h[href='#/"+id+"']"),lhHashSlash=$("._"+pluginPfx+"-h[href='"+loc+"#/"+id+"']");return hHash=hHash.length>0?hHash:lhHash,hHashSlash=hHashSlash.length>0?hHashSlash:lhHashSlash,hHashSlash.length>0?hHashSlash:hHash},_setClasses:function(c,t,h){var cc=opt.clickedClass,tc=opt.targetClass,hc=opt.highlightClass;c&&cc&&""!==cc?($("."+cc).removeClass(cc),_clicked.addClass(cc)):t&&tc&&""!==tc&&h&&hc&&""!==hc&&(functions._currentTarget.call(null,t)?(t.addClass(tc),h.addClass(hc)):(!opt.keepHighlightUntilNext||$("."+hc).length>1)&&(t.removeClass(tc),h.removeClass(hc)))},_extendClasses:function(){var tc=opt.targetClass,hc=opt.highlightClass,$tc=$("."+tc),$hc=$("."+hc),ftc=tc+"-first",ltc=tc+"-last",fhc=hc+"-first",lhc=hc+"-last";$("._"+pluginPfx+"-t").removeClass(ftc+" "+ltc),$("._"+pluginPfx+"-h").removeClass(fhc+" "+lhc),opt.forceSingleHighlight?opt.keepHighlightUntilNext&&$tc.length>1?($tc.slice(0,1).removeClass(tc),$hc.slice(0,1).removeClass(hc)):($tc.slice(1).removeClass(tc),$hc.slice(1).removeClass(hc)):($tc.slice(0,1).addClass(ftc).end().slice(-1).addClass(ltc),$hc.slice(0,1).addClass(fhc).end().slice(-1).addClass(lhc))},_removeClasses:function(destroy){$("."+opt.clickedClass).removeClass(opt.clickedClass),$("."+opt.targetClass).removeClass(opt.targetClass+" "+opt.targetClass+"-first "+opt.targetClass+"-last"),$("."+opt.highlightClass).removeClass(opt.highlightClass+" "+opt.highlightClass+"-first "+opt.highlightClass+"-last"),destroy&&($("._"+pluginPfx+"-t").removeClass("_"+pluginPfx+"-t"),$("._"+pluginPfx+"-h").removeClass("_"+pluginPfx+"-h"))},_currentTarget:function(t){var o=opt["target_"+t.data(pluginPfx).i],dataTarget=t.data("ps2id-target"),rect=dataTarget?$(dataTarget)[0].getBoundingClientRect():t[0].getBoundingClientRect();if("undefined"!=typeof o){var y=t.offset().top,x=t.offset().left,from=o.from?o.from+y:y,to=o.to?o.to+y:y,fromX=o.fromX?o.fromX+x:x,toX=o.toX?o.toX+x:x;return rect.top>=to&&rect.top<=from&&rect.left>=toX&&rect.left<=fromX}var wh=$(window).height(),ww=$(window).width(),th=dataTarget?$(dataTarget).height():t.height(),tw=dataTarget?$(dataTarget).width():t.width(),base=1+th/wh,top=base,bottom=wh>th?base*(wh/th):base,baseX=1+tw/ww,left=baseX,right=ww>tw?baseX*(ww/tw):baseX,val=[rect.top<=wh/top,rect.bottom>=wh/bottom,rect.left<=ww/left,rect.right>=ww/right];if(opt.highlightByNextTarget){var tn=t.data(pluginPfx).tn;if(tn){var rectn=tn[0].getBoundingClientRect();"vertical"===opt.layout?val=[rect.top<=wh/2,rectn.top>wh/2,1,1]:"horizontal"===opt.layout&&(val=[1,1,rect.left<=ww/2,rectn.left>ww/2])}}return val[0]&&val[1]&&val[2]&&val[3]},_scrollTo:function(){opt.scrollSpeed=parseInt(opt.scrollSpeed),_to=opt.pageEndSmoothScroll?functions._pageEndSmoothScroll.call(null):_to;var el=$("html,body"),speed=opt.autoScrollSpeed?functions._autoScrollSpeed.call(null):opt.scrollSpeed,easing=el.is(":animated")?opt.scrollingEasing:opt.scrollEasing,_t=$(window).scrollTop(),_l=$(window).scrollLeft();switch(_axis){case"horizontal":_l!=_to[1]&&(functions._callbacks.call(null,"onStart"),el.stop().animate({scrollLeft:_to[1]},speed,easing).promise().then(function(){functions._callbacks.call(null,"onComplete")}));break;case"auto":if(_t!=_to[0]||_l!=_to[1])if(functions._callbacks.call(null,"onStart"),navigator.userAgent.match(/(iPod|iPhone|iPad|Android)/)){var left;el.stop().animate({pageYOffset:_to[0],pageXOffset:_to[1]},{duration:speed,easing:easing,step:function(now,fx){"pageXOffset"==fx.prop?left=now:"pageYOffset"==fx.prop&&window.scrollTo(left,now)}}).promise().then(function(){functions._callbacks.call(null,"onComplete")})}else el.stop().animate({scrollTop:_to[0],scrollLeft:_to[1]},speed,easing).promise().then(function(){functions._callbacks.call(null,"onComplete")});break;default:_t!=_to[0]&&(functions._callbacks.call(null,"onStart"),el.stop().animate({scrollTop:_to[0]},speed,easing).promise().then(function(){functions._callbacks.call(null,"onComplete")}))}},_pageEndSmoothScroll:function(){var _dh=$(document).height(),_dw=$(document).width(),_wh=$(window).height(),_ww=$(window).width();return[_dh-_to[0]<_wh?_dh-_wh:_to[0],_dw-_to[1]<_ww?_dw-_ww:_to[1]]},_autoScrollSpeed:function(){var _t=$(window).scrollTop(),_l=$(window).scrollLeft(),_h=$(document).height(),_w=$(document).width(),val=[opt.scrollSpeed+opt.scrollSpeed*Math.floor(Math.abs(_to[0]-_t)/_h*100)/100,opt.scrollSpeed+opt.scrollSpeed*Math.floor(Math.abs(_to[1]-_l)/_w*100)/100];return Math.max.apply(Math,val)},_callbacks:function(c){if(opt)switch(this[pluginPfx]={trigger:_trigger,clicked:_clicked,target:_target,scrollTo:{y:_to[0],x:_to[1]}},c){case"onStart":opt.onStart.call(null,this[pluginPfx]);break;case"onComplete":opt.onComplete.call(null,this[pluginPfx])}},_reset:function(){_axis=_offset=_dataOffset=!1},_isInit:function(){_init||methods.init.apply(this)},_live:function(){_liveTimer=setTimeout(function(){opt.live?$(functions._highlightSelector()).length!==_totalInstances&&functions._setup.call(null):_liveTimer&&clearTimeout(_liveTimer),functions._live.call(null)},1e3)},_easing:function(){$.easing.easeInQuad=$.easing.easeInQuad||function(x,t,b,c,d){return c*(t/=d)*t+b},$.easing.easeOutQuad=$.easing.easeOutQuad||function(x,t,b,c,d){return-c*(t/=d)*(t-2)+b},$.easing.easeInOutQuad=$.easing.easeInOutQuad||function(x,t,b,c,d){return(t/=d/2)<1?c/2*t*t+b:-c/2*(--t*(t-2)-1)+b},$.easing.easeInCubic=$.easing.easeInCubic||function(x,t,b,c,d){return c*(t/=d)*t*t+b},$.easing.easeOutCubic=$.easing.easeOutCubic||function(x,t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},$.easing.easeInOutCubic=$.easing.easeInOutCubic||function(x,t,b,c,d){return(t/=d/2)<1?c/2*t*t*t+b:c/2*((t-=2)*t*t+2)+b},$.easing.easeInQuart=$.easing.easeInQuart||function(x,t,b,c,d){return c*(t/=d)*t*t*t+b},$.easing.easeOutQuart=$.easing.easeOutQuart||function(x,t,b,c,d){return-c*((t=t/d-1)*t*t*t-1)+b},$.easing.easeInOutQuart=$.easing.easeInOutQuart||function(x,t,b,c,d){return(t/=d/2)<1?c/2*t*t*t*t+b:-c/2*((t-=2)*t*t*t-2)+b},$.easing.easeInQuint=$.easing.easeInQuint||function(x,t,b,c,d){return c*(t/=d)*t*t*t*t+b},$.easing.easeOutQuint=$.easing.easeOutQuint||function(x,t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},$.easing.easeInOutQuint=$.easing.easeInOutQuint||function(x,t,b,c,d){return(t/=d/2)<1?c/2*t*t*t*t*t+b:c/2*((t-=2)*t*t*t*t+2)+b},$.easing.easeInExpo=$.easing.easeInExpo||function(x,t,b,c,d){return 0==t?b:c*Math.pow(2,10*(t/d-1))+b},$.easing.easeOutExpo=$.easing.easeOutExpo||function(x,t,b,c,d){return t==d?b+c:c*(-Math.pow(2,-10*t/d)+1)+b},$.easing.easeInOutExpo=$.easing.easeInOutExpo||function(x,t,b,c,d){return 0==t?b:t==d?b+c:(t/=d/2)<1?c/2*Math.pow(2,10*(t-1))+b:c/2*(-Math.pow(2,-10*--t)+2)+b},$.easing.easeInSine=$.easing.easeInSine||function(x,t,b,c,d){return-c*Math.cos(t/d*(Math.PI/2))+c+b},$.easing.easeOutSine=$.easing.easeOutSine||function(x,t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b},$.easing.easeInOutSine=$.easing.easeInOutSine||function(x,t,b,c,d){return-c/2*(Math.cos(Math.PI*t/d)-1)+b},$.easing.easeInCirc=$.easing.easeInCirc||function(x,t,b,c,d){return-c*(Math.sqrt(1-(t/=d)*t)-1)+b},$.easing.easeOutCirc=$.easing.easeOutCirc||function(x,t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b},$.easing.easeInOutCirc=$.easing.easeInOutCirc||function(x,t,b,c,d){return(t/=d/2)<1?-c/2*(Math.sqrt(1-t*t)-1)+b:c/2*(Math.sqrt(1-(t-=2)*t)+1)+b},$.easing.easeInElastic=$.easing.easeInElastic||function(x,t,b,c,d){var s=1.70158,p=0,a=c;if(0==t)return b;if(1==(t/=d))return b+c;if(p||(p=.3*d),a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return-(a*Math.pow(2,10*(t-=1))*Math.sin(2*(t*d-s)*Math.PI/p))+b},$.easing.easeOutElastic=$.easing.easeOutElastic||function(x,t,b,c,d){var s=1.70158,p=0,a=c;if(0==t)return b;if(1==(t/=d))return b+c;if(p||(p=.3*d),a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return a*Math.pow(2,-10*t)*Math.sin(2*(t*d-s)*Math.PI/p)+c+b},$.easing.easeInOutElastic=$.easing.easeInOutElastic||function(x,t,b,c,d){var s=1.70158,p=0,a=c;if(0==t)return b;if(2==(t/=d/2))return b+c;if(p||(p=.3*d*1.5),a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return 1>t?-.5*a*Math.pow(2,10*(t-=1))*Math.sin(2*(t*d-s)*Math.PI/p)+b:a*Math.pow(2,-10*(t-=1))*Math.sin(2*(t*d-s)*Math.PI/p)*.5+c+b},$.easing.easeInBack=$.easing.easeInBack||function(x,t,b,c,d,s){return s==undefined&&(s=1.70158),c*(t/=d)*t*((s+1)*t-s)+b},$.easing.easeOutBack=$.easing.easeOutBack||function(x,t,b,c,d,s){return s==undefined&&(s=1.70158),c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},$.easing.easeInOutBack=$.easing.easeInOutBack||function(x,t,b,c,d,s){return s==undefined&&(s=1.70158),(t/=d/2)<1?c/2*t*t*(((s*=1.525)+1)*t-s)+b:c/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+b},$.easing.easeInBounce=$.easing.easeInBounce||function(x,t,b,c,d){return c-$.easing.easeOutBounce(x,d-t,0,c,d)+b},$.easing.easeOutBounce=$.easing.easeOutBounce||function(x,t,b,c,d){return(t/=d)<1/2.75?7.5625*c*t*t+b:2/2.75>t?c*(7.5625*(t-=1.5/2.75)*t+.75)+b:2.5/2.75>t?c*(7.5625*(t-=2.25/2.75)*t+.9375)+b:c*(7.5625*(t-=2.625/2.75)*t+.984375)+b},$.easing.easeInOutBounce=$.easing.easeInOutBounce||function(x,t,b,c,d){return d/2>t?.5*$.easing.easeInBounce(x,2*t,0,c,d)+b:.5*$.easing.easeOutBounce(x,2*t-d,0,c,d)+.5*c+b}}};functions._easing.call(),$.fn[pluginNS]=function(method){return methods[method]?methods[method].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof method&&method?void $.error("Method "+method+" does not exist"):methods.init.apply(this,arguments)},$[pluginNS]=function(method){return methods[method]?methods[method].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof method&&method?void $.error("Method "+method+" does not exist"):methods.init.apply(this,arguments)},$[pluginNS].defaults=defaults}(jQuery,window,document);